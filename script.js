// 28.75 units in 1 cm

const input = document.querySelector('input');
const button = document.querySelector('.download');
const form = document.querySelector('.form');
const text = document.querySelector('.text');
const error = document.querySelector('.error');

form.addEventListener('drop', (event) => {
  getFile(event);
})

text.innerHTML = 'Перетащите в это поле CSV-файл &#10;&#13; с данными участников конференции &#10;&#13; или выберите с помощью кнопки ниже';

const preProceededData = [];
const proceededData = [];
const tableReady = [];
let file_type = '';
let file_name = '';
const filterObject = {};

const logo = '<svg fill="none" height="300" viewBox="0 0 900 300" width="900" xmlns="http://www.w3.org/2000/svg"><path d="m0 0h900v300h-900z" fill="#fff"/><g fill="#000"><path d="m240.268 96.16c-.528 1.656-.996 3.108-1.404 4.356-.408 1.224-.804 2.28-1.188 3.168s-.816 1.632-1.296 2.232c-.456.576-1.008 1.032-1.656 1.368-.648.312-1.452.528-2.412.648v.216c1.008.12 1.848.348 2.52.684.696.312 1.296.78 1.8 1.404.528.6.996 1.392 1.404 2.376.432.96.876 2.136 1.332 3.528.456 1.368.984 2.988 1.584 4.86h-5.76c-.672-2.136-1.236-3.912-1.692-5.328s-.912-2.532-1.368-3.348c-.456-.84-.996-1.44-1.62-1.8s-1.428-.54-2.412-.54l-.036-3.816c.936 0 1.716-.192 2.34-.576.624-.408 1.164-1.008 1.62-1.8.456-.816.876-1.848 1.26-3.096.408-1.272.864-2.784 1.368-4.536zm-13.68 0v7.02c0 .816-.06 1.632-.18 2.448s-.312 1.596-.576 2.34c.192.744.36 1.512.504 2.304.168.768.252 1.488.252 2.16v8.568h-5.472v-24.84zm3.06 10.008v3.816h-4.464v-3.816zm22.313-3.42c2.232 0 4.02.312 5.364.936 1.344.6 2.304 1.584 2.88 2.952.6 1.368.9 3.204.9 5.508 0 2.256-.3 4.068-.9 5.436-.576 1.368-1.536 2.352-2.88 2.952s-3.132.9-5.364.9-4.02-.3-5.364-.9-2.316-1.584-2.916-2.952-.9-3.18-.9-5.436c0-2.304.3-4.14.9-5.508s1.572-2.352 2.916-2.952c1.344-.624 3.132-.936 5.364-.936zm0 3.888c-.912 0-1.632.156-2.16.468s-.9.864-1.116 1.656-.324 1.92-.324 3.384c0 1.44.108 2.556.324 3.348s.588 1.344 1.116 1.656c.528.288 1.248.432 2.16.432s1.632-.144 2.16-.432c.528-.312.888-.864 1.08-1.656.216-.792.324-1.908.324-3.348 0-1.464-.108-2.592-.324-3.384-.192-.792-.552-1.344-1.08-1.656s-1.248-.468-2.16-.468zm18.101-3.42v17.784h-5.256v-17.784zm7.128 6.588v3.636h-7.344v-3.636zm4.932-6.588v17.784h-5.256v-17.784zm15.749-.468c2.928 0 5.268.312 7.02.936 1.752.6 3.024 1.584 3.816 2.952s1.188 3.204 1.188 5.508c0 2.256-.396 4.068-1.188 5.436-.792 1.344-2.064 2.328-3.816 2.952-1.752.6-4.092.9-7.02.9s-5.28-.3-7.056-.9c-1.752-.624-3.024-1.608-3.816-2.952-.792-1.368-1.188-3.18-1.188-5.436 0-2.304.396-4.14 1.188-5.508s2.064-2.352 3.816-2.952c1.776-.624 4.128-.936 7.056-.936zm0 3.708c-1.8 0-3.216.156-4.248.468-1.008.312-1.728.888-2.16 1.728-.408.816-.612 1.98-.612 3.492 0 1.488.204 2.64.612 3.456.432.816 1.152 1.38 2.16 1.692 1.032.312 2.448.468 4.248.468s3.204-.156 4.212-.468 1.716-.876 2.124-1.692.612-1.968.612-3.456c0-1.512-.204-2.676-.612-3.492-.408-.84-1.116-1.416-2.124-1.728s-2.412-.468-4.212-.468zm2.376-10.656v7.776l-.216 1.044v14.328l.216 1.332v7.56h-4.788v-7.56l.216-1.332v-14.292l-.216-1.08v-7.776zm21.708 6.948c3.024 0 5.184.516 6.48 1.548 1.296 1.008 1.956 2.52 1.98 4.536.024 1.632-.384 2.856-1.224 3.672-.84.792-2.292 1.188-4.356 1.188h-9.972v-2.988h8.496c.792 0 1.308-.168 1.548-.504.24-.36.348-.852.324-1.476 0-.84-.24-1.416-.72-1.728-.456-.336-1.248-.504-2.376-.504-.984 0-1.752.132-2.304.396-.528.264-.9.768-1.116 1.512s-.324 1.824-.324 3.24c0 1.488.132 2.64.396 3.456.264.792.708 1.344 1.332 1.656.648.312 1.524.468 2.628.468.84 0 1.86-.024 3.06-.072 1.224-.072 2.448-.18 3.672-.324l.468 3.276c-.672.336-1.452.6-2.34.792s-1.8.324-2.736.396c-.936.096-1.848.144-2.736.144-2.232 0-4.044-.324-5.436-.972-1.368-.672-2.364-1.692-2.988-3.06-.6-1.368-.9-3.12-.9-5.256 0-2.328.312-4.176.936-5.544s1.608-2.352 2.952-2.952 3.096-.9 5.256-.9zm23.704.036c2.256 0 3.864.816 4.824 2.448s1.44 3.972 1.44 7.02c0 2.376-.252 4.236-.756 5.58s-1.26 2.292-2.268 2.844c-.984.528-2.22.792-3.708.792-1.248 0-2.46-.18-3.636-.54-1.152-.36-2.16-.96-3.024-1.8l.324-2.376c.816.24 1.548.456 2.196.648.648.168 1.392.252 2.232.252.768 0 1.38-.132 1.836-.396s.78-.78.972-1.548c.216-.792.324-1.932.324-3.42 0-1.464-.096-2.58-.288-3.348-.192-.792-.504-1.332-.936-1.62-.408-.312-.96-.468-1.656-.468-.792 0-1.512.156-2.16.468-.648.288-1.38.708-2.196 1.26l-.684-2.448c.48-.648 1.092-1.224 1.836-1.728.768-.504 1.608-.9 2.52-1.188s1.848-.432 2.808-.432zm-7.38.432.54 3.24.468.54v11.556l-.18.432c.072.72.12 1.464.144 2.232.048.792.06 1.572.036 2.34v4.284h-5.292v-24.624zm25.723-.468c3.024 0 5.184.516 6.48 1.548 1.296 1.008 1.956 2.52 1.98 4.536.024 1.632-.384 2.856-1.224 3.672-.84.792-2.292 1.188-4.356 1.188h-9.972v-2.988h8.496c.792 0 1.308-.168 1.548-.504.24-.36.348-.852.324-1.476 0-.84-.24-1.416-.72-1.728-.456-.336-1.248-.504-2.376-.504-.984 0-1.752.132-2.304.396-.528.264-.9.768-1.116 1.512s-.324 1.824-.324 3.24c0 1.488.132 2.64.396 3.456.264.792.708 1.344 1.332 1.656.648.312 1.524.468 2.628.468.84 0 1.86-.024 3.06-.072 1.224-.072 2.448-.18 3.672-.324l.468 3.276c-.672.336-1.452.6-2.34.792s-1.8.324-2.736.396c-.936.096-1.848.144-2.736.144-2.232 0-4.044-.324-5.436-.972-1.368-.672-2.364-1.692-2.988-3.06-.6-1.368-.9-3.12-.9-5.256 0-2.328.312-4.176.936-5.544s1.608-2.352 2.952-2.952 3.096-.9 5.256-.9zm17.26.468v17.784h-5.256v-17.784zm7.128 6.588v3.636h-7.344v-3.636zm4.932-6.588v17.784h-5.256v-17.784zm9.736 0v17.784h-5.22v-17.784zm14.148 14.112v3.672h-14.472l-.036-3.672zm-2.628-14.112v17.784h-5.256v-17.784zm2.628 17.604v5.22h-3.492l-.432-5.22zm20.627-17.604v17.784l-4.788.036v-9.324c0-.48.012-.948.036-1.404.048-.456.108-.948.18-1.476h-.144c-.144.432-.348.9-.612 1.404-.264.48-.516.9-.756 1.26l-6.732 9.504h-4.644v-17.784h4.752v9.576c0 .432-.012.864-.036 1.296-.024.408-.072.852-.144 1.332h.108c.192-.456.396-.876.612-1.26.24-.408.48-.792.72-1.152l6.84-9.792zm11.784-.324c1.536 0 2.796.012 3.78.036.984 0 1.848.024 2.592.072.744.024 1.488.072 2.232.144l-.468 3.708c-.216-.048-1.032-.084-2.448-.108s-3.276-.036-5.58-.036c-1.032 0-1.716.168-2.052.504s-.504.9-.504 1.692c0 1.008.168 1.704.504 2.088.36.384 1.068.576 2.124.576h7.992l.108 3.312c-.384 0-.888.012-1.512.036s-1.452.036-2.484.036-2.364 0-3.996 0c-.672 0-1.188.108-1.548.324-.336.192-.564.516-.684.972l-1.188 4.752h-5.436l1.44-5.508c.168-.528.444-.924.828-1.188.408-.288.852-.492 1.332-.612s.912-.204 1.296-.252v-.144c-1.008-.192-1.8-.516-2.376-.972s-.984-1.02-1.224-1.692-.36-1.404-.36-2.196c0-1.008.108-1.86.324-2.556.24-.72.636-1.296 1.188-1.728.576-.456 1.356-.78 2.34-.972 1.008-.192 2.268-.288 3.78-.288zm8.604.252v17.856h-5.184v-17.856zm22.761-7.488c1.08 0 2.064.036 2.952.108s1.728.168 2.52.288c.816.12 1.608.3 2.376.54l-.432 3.996c-.84-.048-1.656-.084-2.448-.108s-1.584-.036-2.376-.036c-.792-.024-1.62-.036-2.484-.036-1.032 0-1.896.108-2.592.324-.672.216-1.212.624-1.62 1.224-.408.576-.708 1.416-.9 2.52-.168 1.08-.252 2.472-.252 4.176 0 2.064.132 3.684.396 4.86s.708 2.016 1.332 2.52c.624.48 1.464.72 2.52.72.72 0 1.38-.072 1.98-.216s1.152-.336 1.656-.576c.504-.264.972-.516 1.404-.756l.576 2.592c-.36.504-.9 1.044-1.62 1.62-.696.576-1.548 1.068-2.556 1.476s-2.16.612-3.456.612c-1.872 0-3.408-.444-4.608-1.332-1.176-.888-2.04-2.28-2.592-4.176-.552-1.92-.828-4.404-.828-7.452 0-3.24.348-5.796 1.044-7.668.72-1.872 1.884-3.204 3.492-3.996 1.632-.816 3.804-1.224 6.516-1.224zm8.712 11.016v14.328h-4.068l-.756-3.78-.504-1.008v-9.54zm9.808-10.512v18.576c0 .6.168 1.056.504 1.368s.816.468 1.44.468h8.676l.252 4.14c-1.704.192-3.492.3-5.364.324-1.848.048-3.696.072-5.544.072-1.8 0-3.168-.48-4.104-1.44-.912-.984-1.368-2.232-1.368-3.744v-19.764zm23.405-.36c2.328 0 4.152.24 5.472.72s2.256 1.308 2.808 2.484c.576 1.176.864 2.82.864 4.932s-.276 3.756-.828 4.932c-.528 1.176-1.404 2.004-2.628 2.484-1.224.456-2.88.684-4.968.684-1.104 0-2.184-.048-3.24-.144s-2.04-.216-2.952-.36-1.692-.288-2.34-.432c-.648-.168-1.092-.324-1.332-.468l.108-2.736h4.392 4.536c.96-.024 1.704-.144 2.232-.36.552-.216.936-.612 1.152-1.188.24-.576.36-1.38.36-2.412 0-1.056-.12-1.872-.36-2.448-.216-.576-.6-.972-1.152-1.188-.528-.24-1.272-.36-2.232-.36-2.208 0-4.104.012-5.688.036s-2.652.072-3.204.144l-.54-3.96c1.008-.12 1.956-.204 2.844-.252s1.848-.072 2.88-.072c1.056-.024 2.328-.036 3.816-.036zm-4.032.36v24.84h-5.508v-24.84zm27.008 13.968v3.384h-10.728v-3.384zm14.114-14.328c2.328 0 4.152.24 5.472.72s2.256 1.308 2.808 2.484c.576 1.176.864 2.82.864 4.932s-.276 3.756-.828 4.932c-.528 1.176-1.404 2.004-2.628 2.484-1.224.456-2.88.684-4.968.684-1.104 0-2.184-.048-3.24-.144s-2.04-.216-2.952-.36-1.692-.288-2.34-.432c-.648-.168-1.092-.324-1.332-.468l.108-2.736h4.392 4.536c.96-.024 1.704-.144 2.232-.36.552-.216.936-.612 1.152-1.188.24-.576.36-1.38.36-2.412 0-1.056-.12-1.872-.36-2.448-.216-.576-.6-.972-1.152-1.188-.528-.24-1.272-.36-2.232-.36-2.208 0-4.104.012-5.688.036s-2.652.072-3.204.144l-.54-3.96c1.008-.12 1.956-.204 2.844-.252s1.848-.072 2.88-.072c1.056-.024 2.328-.036 3.816-.036zm-4.032.36v24.84h-5.508v-24.84zm22.182 0v18.576c0 .6.168 1.056.504 1.368s.816.468 1.44.468h8.676l.252 4.14c-1.704.192-3.492.3-5.364.324-1.848.048-3.696.072-5.544.072-1.8 0-3.168-.48-4.104-1.44-.912-.984-1.368-2.232-1.368-3.744v-19.764zm25.745 0c.456 0 .852.132 1.188.396.36.264.6.612.72 1.044l7.2 23.4h-5.616l-5.076-18.252c-.096-.408-.192-.816-.288-1.224-.096-.432-.18-.84-.252-1.224h-.972c-.072.384-.156.792-.252 1.224-.072.408-.168.816-.288 1.224l-5.076 18.252h-5.652l7.236-23.4c.12-.432.348-.78.684-1.044.36-.264.768-.396 1.224-.396zm3.816 14.148v4.14h-12.888v-4.14zm28.847-14.148v22.86c0 1.32-.66 1.98-1.98 1.98h-3.024c-.6 0-1.056-.132-1.368-.396-.312-.288-.6-.708-.864-1.26l-6.876-13.032c-.288-.552-.576-1.164-.864-1.836-.264-.672-.492-1.32-.684-1.944h-.396c.072.648.132 1.308.18 1.98.048.648.072 1.296.072 1.944v14.544h-5.22v-22.86c0-1.32.672-1.98 2.016-1.98h2.988c.576 0 1.008.144 1.296.432.312.264.612.672.9 1.224l6.66 12.636c.288.552.588 1.164.9 1.836s.612 1.368.9 2.088h.432c-.072-.72-.132-1.416-.18-2.088-.024-.696-.036-1.38-.036-2.052l-.036-14.076zm10.069-.108c1.344 0 2.7.012 4.068.036 1.368 0 2.712.024 4.032.072s2.556.132 3.708.252l-.252 3.996h-9.54c-.6 0-1.056.156-1.368.468-.288.312-.432.768-.432 1.368v12.672c0 .6.144 1.056.432 1.368.312.312.768.468 1.368.468h9.54l.252 3.996c-1.152.096-2.388.18-3.708.252-1.32.048-2.664.072-4.032.072-1.368.024-2.724.036-4.068.036-1.584 0-2.868-.456-3.852-1.368-.96-.936-1.44-2.148-1.44-3.636v-15.048c0-1.512.48-2.724 1.44-3.636.984-.912 2.268-1.368 3.852-1.368zm-4.644 10.08h14.868v3.888h-14.868zm31.432-9.972v24.84h-5.508v-24.84zm7.488 0v4.32h-20.448v-4.32z"/><path d="m235.33 157.152c.704 0 1.304.016 1.8.048.512.032.976.088 1.392.168.432.064.872.152 1.32.264l-.216 1.608c-.48-.048-.928-.088-1.344-.12-.4-.032-.832-.056-1.296-.072s-1.016-.024-1.656-.024c-1.072 0-1.92.208-2.544.624s-1.072 1.112-1.344 2.088c-.256.976-.384 2.304-.384 3.984s.128 3.008.384 3.984c.272.976.72 1.672 1.344 2.088s1.472.624 2.544.624c1.024 0 1.88-.016 2.568-.048.704-.048 1.392-.12 2.064-.216l.216 1.584c-.688.192-1.4.328-2.136.408-.72.096-1.624.144-2.712.144-1.584 0-2.856-.272-3.816-.816-.944-.56-1.632-1.464-2.064-2.712-.416-1.248-.624-2.928-.624-5.04s.208-3.792.624-5.04c.432-1.248 1.12-2.144 2.064-2.688.96-.56 2.232-.84 3.816-.84zm12.396 4.872c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm13.495-1.56c1.216 0 2.176.088 2.88.264.72.176 1.24.488 1.56.936s.48 1.088.48 1.92-.2 1.464-.6 1.896c-.384.416-1.024.664-1.92.744v.072c1.088.08 1.848.384 2.28.912.432.512.648 1.24.648 2.184 0 .8-.16 1.424-.48 1.872-.304.432-.8.736-1.488.912-.672.176-1.576.264-2.712.264-.816 0-1.528-.008-2.136-.024-.608 0-1.168-.016-1.68-.048-.496-.016-1.024-.04-1.584-.072l.288-1.512c.32.016.912.032 1.776.048h3.048c.72 0 1.296-.048 1.728-.144.432-.112.736-.304.912-.576.192-.272.288-.656.288-1.152 0-.752-.224-1.264-.672-1.536-.448-.288-1.24-.432-2.376-.432h-4.728v-1.464h4.728c.672 0 1.208-.048 1.608-.144s.688-.272.864-.528c.176-.272.264-.64.264-1.104 0-.448-.096-.792-.288-1.032s-.512-.408-.96-.504-1.048-.144-1.8-.144c-.688-.016-1.312-.024-1.872-.024-.544 0-1.024.008-1.44.024-.416 0-.776.016-1.08.048l-.288-1.512c.496-.048.968-.08 1.416-.096s.936-.024 1.464-.024c.528-.016 1.152-.024 1.872-.024zm-2.832.144v11.688h-1.92v-11.688zm24.497-.024c.512 0 .768.256.768.768l.504 10.92h-1.896l-.456-10.128h-.408l-2.976 8.184c-.064.208-.16.376-.288.504-.128.112-.304.168-.528.168h-1.584c-.224 0-.4-.056-.528-.168-.112-.128-.208-.296-.288-.504l-2.976-8.184h-.408l-.432 10.128h-1.872l.48-10.92c0-.512.264-.768.792-.768h2.112c.224 0 .392.056.504.168.128.112.224.28.288.504l2.424 6.72c.112.288.208.568.288.84s.152.552.216.84h.384c.08-.304.16-.592.24-.864s.168-.544.264-.816l2.424-6.72c.144-.448.416-.672.816-.672zm9.555-.288c1.76 0 3.032.32 3.816.96.8.64 1.208 1.592 1.224 2.856 0 1.04-.224 1.856-.672 2.448-.432.576-1.136.864-2.112.864h-6.84v-1.584h6.312c.512 0 .848-.176 1.008-.528.176-.368.256-.768.24-1.2 0-.752-.216-1.288-.648-1.608s-1.176-.48-2.232-.48c-.848 0-1.52.128-2.016.384-.48.24-.824.672-1.032 1.296-.192.608-.288 1.464-.288 2.568 0 1.248.12 2.2.36 2.856.256.656.656 1.104 1.2 1.344s1.264.36 2.16.36c.64 0 1.328-.024 2.064-.072.752-.064 1.424-.136 2.016-.216l.192 1.368c-.352.144-.8.264-1.344.36s-1.104.168-1.68.216c-.56.048-1.064.072-1.512.072-1.328 0-2.408-.2-3.24-.6-.816-.416-1.408-1.072-1.776-1.968-.368-.912-.552-2.112-.552-3.6 0-1.536.184-2.744.552-3.624.384-.896.968-1.528 1.752-1.896.784-.384 1.8-.576 3.048-.576zm13.153 0c.352 0 .744.016 1.176.048.448.032.896.088 1.344.168s.864.192 1.248.336l-.264 1.32c-.528-.048-1.088-.08-1.68-.096-.576-.032-1.072-.048-1.488-.048-.912 0-1.648.128-2.208.384-.544.256-.936.704-1.176 1.344s-.36 1.528-.36 2.664.12 2.032.36 2.688c.24.64.632 1.088 1.176 1.344.56.256 1.296.384 2.208.384.24 0 .552-.008.936-.024.4-.016.816-.04 1.248-.072.448-.032.872-.08 1.272-.144l.192 1.368c-.576.208-1.216.36-1.92.456-.688.096-1.376.144-2.064.144-1.344 0-2.424-.2-3.24-.6s-1.408-1.048-1.776-1.944c-.352-.896-.528-2.096-.528-3.6s.176-2.704.528-3.6c.368-.896.96-1.536 1.776-1.92.816-.4 1.896-.6 3.24-.6zm11.836.288v11.688h-2.04v-11.688zm4.224 0v1.68h-10.512v-1.68zm4.542 0v11.688h-2.016v-11.688zm6.36 4.704v1.56h-6.504v-1.56zm1.8-4.704v11.688h-2.016v-11.688zm8.761-.288c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm19.078-1.728c.352 0 .744.016 1.176.048.448.032.896.088 1.344.168s.864.192 1.248.336l-.264 1.32c-.528-.048-1.088-.08-1.68-.096-.576-.032-1.072-.048-1.488-.048-.912 0-1.648.128-2.208.384-.544.256-.936.704-1.176 1.344s-.36 1.528-.36 2.664.12 2.032.36 2.688c.24.64.632 1.088 1.176 1.344.56.256 1.296.384 2.208.384.24 0 .552-.008.936-.024.4-.016.816-.04 1.248-.072.448-.032.872-.08 1.272-.144l.192 1.368c-.576.208-1.216.36-1.92.456-.688.096-1.376.144-2.064.144-1.344 0-2.424-.2-3.24-.6s-1.408-1.048-1.776-1.944c-.352-.896-.528-2.096-.528-3.6s.176-2.704.528-3.6c.368-.896.96-1.536 1.776-1.92.816-.4 1.896-.6 3.24-.6zm18.837-4.584c.192 0 .36.056.504.168.144.096.24.232.288.408l5.328 15.984h-2.184l-4.296-13.584c-.064-.224-.136-.448-.216-.672-.064-.24-.128-.464-.192-.672h-.672c-.064.208-.128.432-.192.672-.064.224-.136.448-.216.672l-4.296 13.584h-2.184l5.328-15.984c.048-.176.144-.312.288-.408.144-.112.312-.168.504-.168zm3.072 9.552v1.824h-8.4v-1.824zm10.107-4.968c.352 0 .744.016 1.176.048.448.032.896.088 1.344.168s.864.192 1.248.336l-.264 1.32c-.528-.048-1.088-.08-1.68-.096-.576-.032-1.072-.048-1.488-.048-.912 0-1.648.128-2.208.384-.544.256-.936.704-1.176 1.344s-.36 1.528-.36 2.664.12 2.032.36 2.688c.24.64.632 1.088 1.176 1.344.56.256 1.296.384 2.208.384.24 0 .552-.008.936-.024.4-.016.816-.04 1.248-.072.448-.032.872-.08 1.272-.144l.192 1.368c-.576.208-1.216.36-1.92.456-.688.096-1.376.144-2.064.144-1.344 0-2.424-.2-3.24-.6s-1.408-1.048-1.776-1.944c-.352-.896-.528-2.096-.528-3.6s.176-2.704.528-3.6c.368-.896.96-1.536 1.776-1.92.816-.4 1.896-.6 3.24-.6zm11.625 0c.352 0 .744.016 1.176.048.448.032.896.088 1.344.168s.864.192 1.248.336l-.264 1.32c-.528-.048-1.088-.08-1.68-.096-.576-.032-1.072-.048-1.488-.048-.912 0-1.648.128-2.208.384-.544.256-.936.704-1.176 1.344s-.36 1.528-.36 2.664.12 2.032.36 2.688c.24.64.632 1.088 1.176 1.344.56.256 1.296.384 2.208.384.24 0 .552-.008.936-.024.4-.016.816-.04 1.248-.072.448-.032.872-.08 1.272-.144l.192 1.368c-.576.208-1.216.36-1.92.456-.688.096-1.376.144-2.064.144-1.344 0-2.424-.2-3.24-.6s-1.408-1.048-1.776-1.944c-.352-.896-.528-2.096-.528-3.6s.176-2.704.528-3.6c.368-.896.96-1.536 1.776-1.92.816-.4 1.896-.6 3.24-.6zm11.601 0c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm10.759-1.44v11.688h-1.992v-11.688zm9.432 10.056v1.632h-9.6l-.024-1.632zm-1.584-10.056-.024 11.688h-2.016v-11.688zm1.584 11.568v3.576h-1.344l-.216-3.576zm13.074-11.568v11.688h-1.848v-7.752c0-.256.008-.504.024-.744.016-.256.032-.528.048-.816h-.048c-.096.224-.224.464-.384.72-.144.24-.288.456-.432.648l-5.952 7.944h-1.68v-11.688h1.848v7.752c0 .256-.008.512-.024.768 0 .24-.016.504-.048.792h.048c.128-.24.264-.48.408-.72s.288-.448.432-.624l5.952-7.968zm9.358-.288c.864 0 1.592.12 2.184.36.592.224 1.04.608 1.344 1.152s.456 1.288.456 2.232v8.232h-1.608l-.312-2.544-.12-.264v-5.424c-.016-.72-.184-1.232-.504-1.536-.32-.32-.944-.48-1.872-.48-.624 0-1.4.032-2.328.096-.912.064-1.816.136-2.712.216l-.192-1.512c.544-.096 1.144-.184 1.8-.264s1.32-.144 1.992-.192 1.296-.072 1.872-.072zm3.024 4.776-.024 1.536-5.568.024c-.56.016-.96.168-1.2.456-.224.272-.336.656-.336 1.152v.744c0 .608.144 1.056.432 1.344.304.272.768.408 1.392.408.448 0 .952-.08 1.512-.24.576-.176 1.152-.44 1.728-.792s1.104-.8 1.584-1.344v1.512c-.16.224-.408.488-.744.792-.32.288-.712.576-1.176.864-.448.272-.952.504-1.512.696-.56.176-1.16.264-1.8.264-.688 0-1.296-.12-1.824-.36-.528-.256-.936-.624-1.224-1.104-.288-.496-.432-1.096-.432-1.8v-1.272c0-.912.28-1.616.84-2.112.576-.512 1.376-.768 2.4-.768zm6.69-4.488v11.688h-1.992v-11.688zm9.432 10.056v1.632h-9.6l-.024-1.632zm-1.584-10.056-.024 11.688h-2.016v-11.688zm1.584 11.568v3.576h-1.344l-.216-3.576zm13.074-11.568v11.688h-1.848v-7.752c0-.256.008-.504.024-.744.016-.256.032-.528.048-.816h-.048c-.096.224-.224.464-.384.72-.144.24-.288.456-.432.648l-5.952 7.944h-1.68v-11.688h1.848v7.752c0 .256-.008.512-.024.768 0 .24-.016.504-.048.792h.048c.128-.24.264-.48.408-.72s.288-.448.432-.624l5.952-7.968zm8.614-.288c1.76 0 3.032.32 3.816.96.8.64 1.208 1.592 1.224 2.856 0 1.04-.224 1.856-.672 2.448-.432.576-1.136.864-2.112.864h-6.84v-1.584h6.312c.512 0 .848-.176 1.008-.528.176-.368.256-.768.24-1.2 0-.752-.216-1.288-.648-1.608s-1.176-.48-2.232-.48c-.848 0-1.52.128-2.016.384-.48.24-.824.672-1.032 1.296-.192.608-.288 1.464-.288 2.568 0 1.248.12 2.2.36 2.856.256.656.656 1.104 1.2 1.344s1.264.36 2.16.36c.64 0 1.328-.024 2.064-.072.752-.064 1.424-.136 2.016-.216l.192 1.368c-.352.144-.8.264-1.344.36s-1.104.168-1.68.216c-.56.048-1.064.072-1.512.072-1.328 0-2.408-.2-3.24-.6-.816-.416-1.408-1.072-1.776-1.968-.368-.912-.552-2.112-.552-3.6 0-1.536.184-2.744.552-3.624.384-.896.968-1.528 1.752-1.896.784-.384 1.8-.576 3.048-.576zm18.433.288v11.688h-1.848v-7.752c0-.256.008-.504.024-.744.016-.256.032-.528.048-.816h-.048c-.096.224-.224.464-.384.72-.144.24-.288.456-.432.648l-5.952 7.944h-1.68v-11.688h1.848v7.752c0 .256-.008.512-.024.768 0 .24-.016.504-.048.792h.048c.128-.24.264-.48.408-.72s.288-.448.432-.624l5.952-7.968zm-3.168-5.184h1.56c.048.624-.072 1.184-.36 1.68-.272.496-.688.896-1.248 1.2-.544.288-1.2.432-1.968.432s-1.432-.144-1.992-.432c-.56-.304-.984-.704-1.272-1.2-.272-.496-.392-1.056-.36-1.68h1.56c0 .688.176 1.224.528 1.608.368.368.88.552 1.536.552.64 0 1.136-.184 1.488-.552.352-.384.528-.92.528-1.608zm17.318 4.896c.352 0 .744.016 1.176.048.448.032.896.088 1.344.168s.864.192 1.248.336l-.264 1.32c-.528-.048-1.088-.08-1.68-.096-.576-.032-1.072-.048-1.488-.048-.912 0-1.648.128-2.208.384-.544.256-.936.704-1.176 1.344s-.36 1.528-.36 2.664.12 2.032.36 2.688c.24.64.632 1.088 1.176 1.344.56.256 1.296.384 2.208.384.24 0 .552-.008.936-.024.4-.016.816-.04 1.248-.072.448-.032.872-.08 1.272-.144l.192 1.368c-.576.208-1.216.36-1.92.456-.688.096-1.376.144-2.064.144-1.344 0-2.424-.2-3.24-.6s-1.408-1.048-1.776-1.944c-.352-.896-.528-2.096-.528-3.6s.176-2.704.528-3.6c.368-.896.96-1.536 1.776-1.92.816-.4 1.896-.6 3.24-.6zm16.828.288v11.688h-2.016v-11.688zm-8.016 0v11.688h-1.992v-11.688zm6.216 0-.024 1.656h-6.312v-1.656zm10.397-.288c1.76 0 3.032.32 3.816.96.8.64 1.208 1.592 1.224 2.856 0 1.04-.224 1.856-.672 2.448-.432.576-1.136.864-2.112.864h-6.84v-1.584h6.312c.512 0 .848-.176 1.008-.528.176-.368.256-.768.24-1.2 0-.752-.216-1.288-.648-1.608s-1.176-.48-2.232-.48c-.848 0-1.52.128-2.016.384-.48.24-.824.672-1.032 1.296-.192.608-.288 1.464-.288 2.568 0 1.248.12 2.2.36 2.856.256.656.656 1.104 1.2 1.344s1.264.36 2.16.36c.64 0 1.328-.024 2.064-.072.752-.064 1.424-.136 2.016-.216l.192 1.368c-.352.144-.8.264-1.344.36s-1.104.168-1.68.216c-.56.048-1.064.072-1.512.072-1.328 0-2.408-.2-3.24-.6-.816-.416-1.408-1.072-1.776-1.968-.368-.912-.552-2.112-.552-3.6 0-1.536.184-2.744.552-3.624.384-.896.968-1.528 1.752-1.896.784-.384 1.8-.576 3.048-.576zm10.177.288v11.688h-1.992v-11.688zm9.432 10.056v1.632h-9.6l-.024-1.632zm-1.584-10.056-.024 11.688h-2.016v-11.688zm1.584 11.568v3.576h-1.344l-.216-3.576zm13.074-11.568v11.688h-1.848v-7.752c0-.256.008-.504.024-.744.016-.256.032-.528.048-.816h-.048c-.096.224-.224.464-.384.72-.144.24-.288.456-.432.648l-5.952 7.944h-1.68v-11.688h1.848v7.752c0 .256-.008.512-.024.768 0 .24-.016.504-.048.792h.048c.128-.24.264-.48.408-.72s.288-.448.432-.624l5.952-7.968zm9.358-.288c.864 0 1.592.12 2.184.36.592.224 1.04.608 1.344 1.152s.456 1.288.456 2.232v8.232h-1.608l-.312-2.544-.12-.264v-5.424c-.016-.72-.184-1.232-.504-1.536-.32-.32-.944-.48-1.872-.48-.624 0-1.4.032-2.328.096-.912.064-1.816.136-2.712.216l-.192-1.512c.544-.096 1.144-.184 1.8-.264s1.32-.144 1.992-.192 1.296-.072 1.872-.072zm3.024 4.776-.024 1.536-5.568.024c-.56.016-.96.168-1.2.456-.224.272-.336.656-.336 1.152v.744c0 .608.144 1.056.432 1.344.304.272.768.408 1.392.408.448 0 .952-.08 1.512-.24.576-.176 1.152-.44 1.728-.792s1.104-.8 1.584-1.344v1.512c-.16.224-.408.488-.744.792-.32.288-.712.576-1.176.864-.448.272-.952.504-1.512.696-.56.176-1.16.264-1.8.264-.688 0-1.296-.12-1.824-.36-.528-.256-.936-.624-1.224-1.104-.288-.496-.432-1.096-.432-1.8v-1.272c0-.912.28-1.616.84-2.112.576-.512 1.376-.768 2.4-.768zm14.034-4.488v1.608h-4.272c-.496 0-.856.112-1.08.336-.208.208-.352.584-.432 1.128-.08.704-.176 1.424-.288 2.16-.096.736-.208 1.448-.336 2.136s-.296 1.304-.504 1.848c-.192.56-.456 1.032-.792 1.416s-.744.672-1.224.864c-.464.192-1.016.296-1.656.312l-.216-1.56c.432-.112.776-.24 1.032-.384.272-.144.48-.32.624-.528.16-.208.296-.448.408-.72.144-.384.272-.824.384-1.32s.208-1.016.288-1.56.144-1.072.192-1.584c.064-.528.12-1 .168-1.416.112-.896.4-1.576.864-2.04.48-.464 1.208-.696 2.184-.696zm.312 0v11.688h-2.04v-11.688zm14.076 0v11.688h-1.848v-7.752c0-.256.008-.504.024-.744.016-.256.032-.528.048-.816h-.048c-.096.224-.224.464-.384.72-.144.24-.288.456-.432.648l-5.952 7.944h-1.68v-11.688h1.848v7.752c0 .256-.008.512-.024.768 0 .24-.016.504-.048.792h.048c.128-.24.264-.48.408-.72s.288-.448.432-.624l5.952-7.968zm8.806-.288c.352 0 .744.016 1.176.048.448.032.896.088 1.344.168s.864.192 1.248.336l-.264 1.32c-.528-.048-1.088-.08-1.68-.096-.576-.032-1.072-.048-1.488-.048-.912 0-1.648.128-2.208.384-.544.256-.936.704-1.176 1.344s-.36 1.528-.36 2.664.12 2.032.36 2.688c.24.64.632 1.088 1.176 1.344.56.256 1.296.384 2.208.384.24 0 .552-.008.936-.024.4-.016.816-.04 1.248-.072.448-.032.872-.08 1.272-.144l.192 1.368c-.576.208-1.216.36-1.92.456-.688.096-1.376.144-2.064.144-1.344 0-2.424-.2-3.24-.6s-1.408-1.048-1.776-1.944c-.352-.896-.528-2.096-.528-3.6s.176-2.704.528-3.6c.368-.896.96-1.536 1.776-1.92.816-.4 1.896-.6 3.24-.6zm11.837.288v11.688h-2.04v-11.688zm4.224 0v1.68h-10.512v-1.68zm7.306-.288c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm13.495-1.56c1.216 0 2.176.088 2.88.264.72.176 1.24.488 1.56.936s.48 1.088.48 1.92-.2 1.464-.6 1.896c-.384.416-1.024.664-1.92.744v.072c1.088.08 1.848.384 2.28.912.432.512.648 1.24.648 2.184 0 .8-.16 1.424-.48 1.872-.304.432-.8.736-1.488.912-.672.176-1.576.264-2.712.264-.816 0-1.528-.008-2.136-.024-.608 0-1.168-.016-1.68-.048-.496-.016-1.024-.04-1.584-.072l.288-1.512c.32.016.912.032 1.776.048h3.048c.72 0 1.296-.048 1.728-.144.432-.112.736-.304.912-.576.192-.272.288-.656.288-1.152 0-.752-.224-1.264-.672-1.536-.448-.288-1.24-.432-2.376-.432h-4.728v-1.464h4.728c.672 0 1.208-.048 1.608-.144s.688-.272.864-.528c.176-.272.264-.64.264-1.104 0-.448-.096-.792-.288-1.032s-.512-.408-.96-.504-1.048-.144-1.8-.144c-.688-.016-1.312-.024-1.872-.024-.544 0-1.024.008-1.44.024-.416 0-.776.016-1.08.048l-.288-1.512c.496-.048.968-.08 1.416-.096s.936-.024 1.464-.024c.528-.016 1.152-.024 1.872-.024zm-2.832.144v11.688h-1.92v-11.688zm-428.002 28.976v11.688h-2.016v-11.688zm-8.016 0v11.688h-1.992v-11.688zm6.216 0-.024 1.656h-6.312v-1.656zm10.565-.288c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm23.446-1.44v1.608h-4.272c-.496 0-.856.112-1.08.336-.208.208-.352.584-.432 1.128-.08.704-.176 1.424-.288 2.16-.096.736-.208 1.448-.336 2.136s-.296 1.304-.504 1.848c-.192.56-.456 1.032-.792 1.416s-.744.672-1.224.864c-.464.192-1.016.296-1.656.312l-.216-1.56c.432-.112.776-.24 1.032-.384.272-.144.48-.32.624-.528.16-.208.296-.448.408-.72.144-.384.272-.824.384-1.32s.208-1.016.288-1.56.144-1.072.192-1.584c.064-.528.12-1 .168-1.416.112-.896.4-1.576.864-2.04.48-.464 1.208-.696 2.184-.696zm.312 0v11.688h-2.04v-11.688zm9.349-.288c.864 0 1.592.12 2.184.36.592.224 1.04.608 1.344 1.152s.456 1.288.456 2.232v8.232h-1.608l-.312-2.544-.12-.264v-5.424c-.016-.72-.184-1.232-.504-1.536-.32-.32-.944-.48-1.872-.48-.624 0-1.4.032-2.328.096-.912.064-1.816.136-2.712.216l-.192-1.512c.544-.096 1.144-.184 1.8-.264s1.32-.144 1.992-.192 1.296-.072 1.872-.072zm3.024 4.776-.024 1.536-5.568.024c-.56.016-.96.168-1.2.456-.224.272-.336.656-.336 1.152v.744c0 .608.144 1.056.432 1.344.304.272.768.408 1.392.408.448 0 .952-.08 1.512-.24.576-.176 1.152-.44 1.728-.792s1.104-.8 1.584-1.344v1.512c-.16.224-.408.488-.744.792-.32.288-.712.576-1.176.864-.448.272-.952.504-1.512.696-.56.176-1.16.264-1.8.264-.688 0-1.296-.12-1.824-.36-.528-.256-.936-.624-1.224-1.104-.288-.496-.432-1.096-.432-1.8v-1.272c0-.912.28-1.616.84-2.112.576-.512 1.376-.768 2.4-.768zm14.13-10.488.48 1.584c-.48.304-.928.536-1.344.696s-.824.28-1.224.36c-.384.08-.784.16-1.2.24-.4.064-.824.16-1.272.288-.816.224-1.456.544-1.92.96-.448.416-.776.88-.984 1.392s-.352 1.048-.432 1.608c-.064.368-.112.704-.144 1.008s-.056.536-.072.696h.048c.128-.288.288-.576.48-.864.208-.304.472-.576.792-.816.336-.24.76-.432 1.272-.576s1.152-.216 1.92-.216c1.152 0 2.064.192 2.736.576.688.384 1.176.992 1.464 1.824.304.816.456 1.896.456 3.24 0 1.232-.144 2.296-.432 3.192s-.824 1.584-1.608 2.064c-.768.48-1.872.72-3.312.72-1.008 0-1.84-.12-2.496-.36s-1.176-.576-1.56-1.008-.672-.952-.864-1.56c-.176-.608-.296-1.28-.36-2.016-.048-.752-.072-1.552-.072-2.4 0-1.264.048-2.392.144-3.384.112-.992.312-1.856.6-2.592.304-.736.752-1.352 1.344-1.848.592-.512 1.368-.912 2.328-1.2.464-.144.904-.256 1.32-.336.432-.08.856-.16 1.272-.24s.84-.192 1.272-.336c.432-.16.888-.392 1.368-.696zm-4.128 8.088c-.96 0-1.688.152-2.184.456-.48.304-.808.744-.984 1.32-.16.576-.24 1.288-.24 2.136 0 1.072.104 1.92.312 2.544s.552 1.064 1.032 1.32 1.12.384 1.92.384c.784 0 1.408-.128 1.872-.384s.8-.688 1.008-1.296c.208-.624.312-1.48.312-2.568 0-1.008-.096-1.792-.288-2.352-.176-.576-.488-.976-.936-1.2-.432-.24-1.04-.36-1.824-.36zm13.421-2.376c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm15.439-1.728c1.44 0 2.472.528 3.096 1.584.624 1.04.936 2.576.936 4.608 0 1.504-.16 2.704-.48 3.6-.32.88-.808 1.512-1.464 1.896s-1.48.576-2.472.576c-.768 0-1.528-.104-2.28-.312s-1.472-.528-2.16-.96l.12-1.224c.752.208 1.408.384 1.968.528.576.128 1.184.192 1.824.192.688 0 1.232-.12 1.632-.36.416-.24.72-.672.912-1.296s.288-1.504.288-2.64c0-1.104-.088-1.976-.264-2.616-.16-.64-.432-1.096-.816-1.368-.368-.288-.864-.432-1.488-.432-.64 0-1.272.152-1.896.456s-1.352.768-2.184 1.392l-.216-1.368c.432-.464.92-.864 1.464-1.2s1.112-.592 1.704-.768c.608-.192 1.2-.288 1.776-.288zm-5.016.288.24 2.424.12.312v7.488l-.096.288c.048.448.08.88.096 1.296s.016.856 0 1.32v3.384h-2.016v-16.512zm17.857-.288c.864 0 1.592.12 2.184.36.592.224 1.04.608 1.344 1.152s.456 1.288.456 2.232v8.232h-1.608l-.312-2.544-.12-.264v-5.424c-.016-.72-.184-1.232-.504-1.536-.32-.32-.944-.48-1.872-.48-.624 0-1.4.032-2.328.096-.912.064-1.816.136-2.712.216l-.192-1.512c.544-.096 1.144-.184 1.8-.264s1.32-.144 1.992-.192 1.296-.072 1.872-.072zm3.024 4.776-.024 1.536-5.568.024c-.56.016-.96.168-1.2.456-.224.272-.336.656-.336 1.152v.744c0 .608.144 1.056.432 1.344.304.272.768.408 1.392.408.448 0 .952-.08 1.512-.24.576-.176 1.152-.44 1.728-.792s1.104-.8 1.584-1.344v1.512c-.16.224-.408.488-.744.792-.32.288-.712.576-1.176.864-.448.272-.952.504-1.512.696-.56.176-1.16.264-1.8.264-.688 0-1.296-.12-1.824-.36-.528-.256-.936-.624-1.224-1.104-.288-.496-.432-1.096-.432-1.8v-1.272c0-.912.28-1.616.84-2.112.576-.512 1.376-.768 2.4-.768zm9.69-4.488v11.688h-2.04v-11.688zm4.224 0v1.68h-10.512v-1.68zm7.306-.288c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm15.439-1.728c1.44 0 2.472.528 3.096 1.584.624 1.04.936 2.576.936 4.608 0 1.504-.16 2.704-.48 3.6-.32.88-.808 1.512-1.464 1.896s-1.48.576-2.472.576c-.768 0-1.528-.104-2.28-.312s-1.472-.528-2.16-.96l.12-1.224c.752.208 1.408.384 1.968.528.576.128 1.184.192 1.824.192.688 0 1.232-.12 1.632-.36.416-.24.72-.672.912-1.296s.288-1.504.288-2.64c0-1.104-.088-1.976-.264-2.616-.16-.64-.432-1.096-.816-1.368-.368-.288-.864-.432-1.488-.432-.64 0-1.272.152-1.896.456s-1.352.768-2.184 1.392l-.216-1.368c.432-.464.92-.864 1.464-1.2s1.112-.592 1.704-.768c.608-.192 1.2-.288 1.776-.288zm-5.016.288.24 2.424.12.312v7.488l-.096.288c.048.448.08.88.096 1.296s.016.856 0 1.32v3.384h-2.016v-16.512zm14.328 0v11.688h-2.016v-11.688zm6.36 4.704v1.56h-6.504v-1.56zm1.8-4.704v11.688h-2.016v-11.688zm8.545 4.536c1.168 0 2.08.112 2.736.336s1.12.608 1.392 1.152c.288.528.432 1.248.432 2.16 0 .944-.144 1.688-.432 2.232-.288.528-.744.896-1.368 1.104s-1.44.312-2.448.312c-.768 0-1.432-.008-1.992-.024-.56 0-1.072-.016-1.536-.048-.464-.016-.952-.04-1.464-.072l.264-1.536c.288.016.824.032 1.608.048.8.016 1.736.024 2.808.024.624 0 1.112-.056 1.464-.168.368-.112.632-.32.792-.624s.24-.744.24-1.32c0-.768-.176-1.304-.528-1.608-.336-.304-.992-.456-1.968-.456h-4.44v-1.512zm-2.76-4.536v11.688h-1.992v-11.688zm11.52 0v11.688h-2.064v-11.688zm16.913 0c.512 0 .768.256.768.768l.504 10.92h-1.896l-.456-10.128h-.408l-2.976 8.184c-.064.208-.16.376-.288.504-.128.112-.304.168-.528.168h-1.584c-.224 0-.4-.056-.528-.168-.112-.128-.208-.296-.288-.504l-2.976-8.184h-.408l-.432 10.128h-1.872l.48-10.92c0-.512.264-.768.792-.768h2.112c.224 0 .392.056.504.168.128.112.224.28.288.504l2.424 6.72c.112.288.208.568.288.84s.152.552.216.84h.384c.08-.304.16-.592.24-.864s.168-.544.264-.816l2.424-6.72c.144-.448.416-.672.816-.672zm26.056 0c-.256.688-.496 1.312-.72 1.872-.208.56-.424 1.056-.648 1.488s-.472.808-.744 1.128c-.256.304-.56.552-.912.744-.352.176-.768.288-1.248.336v.048c.512.048.952.168 1.32.36.368.176.688.424.96.744.288.304.552.696.792 1.176.24.464.48 1.016.72 1.656.256.624.528 1.336.816 2.136h-2.088c-.368-.928-.696-1.728-.984-2.4s-.576-1.224-.864-1.656c-.272-.432-.592-.744-.96-.936-.352-.208-.792-.312-1.32-.312v-1.536c.48 0 .896-.112 1.248-.336.368-.224.688-.544.96-.96s.536-.92.792-1.512c.256-.608.528-1.288.816-2.04zm-14.592 0c.288.752.56 1.432.816 2.04.272.592.544 1.096.816 1.512s.584.736.936.96.768.336 1.248.336v1.536c-.512 0-.952.104-1.32.312-.352.192-.672.504-.96.936-.272.432-.552.984-.84 1.656-.272.672-.6 1.472-.984 2.4h-2.088c.288-.8.552-1.512.792-2.136.256-.64.504-1.192.744-1.656.24-.48.496-.872.768-1.176.288-.32.616-.568.984-.744.384-.192.824-.312 1.32-.36v-.048c-.48-.048-.896-.16-1.248-.336-.336-.192-.64-.44-.912-.744-.272-.32-.52-.696-.744-1.128s-.448-.928-.672-1.488c-.208-.56-.44-1.184-.696-1.872zm5.832 4.848v1.536h-2.568v-1.536zm1.392-4.848v3.48c0 .368-.024.728-.072 1.08-.032.336-.104.672-.216 1.008.08.336.144.672.192 1.008.064.336.096.656.096.96v4.152h-1.8v-4.152c0-.304.024-.624.072-.96.064-.336.136-.672.216-1.008-.112-.336-.192-.672-.24-1.008-.032-.352-.048-.712-.048-1.08v-3.48zm2.064 4.848v1.536h-2.448v-1.536zm18.626-4.848v11.688h-1.848v-7.752c0-.256.008-.504.024-.744.016-.256.032-.528.048-.816h-.048c-.096.224-.224.464-.384.72-.144.24-.288.456-.432.648l-5.952 7.944h-1.68v-11.688h1.848v7.752c0 .256-.008.512-.024.768 0 .24-.016.504-.048.792h.048c.128-.24.264-.48.408-.72s.288-.448.432-.624l5.952-7.968zm8.566-.12c1.216 0 2.176.088 2.88.264.72.176 1.24.488 1.56.936s.48 1.088.48 1.92-.2 1.464-.6 1.896c-.384.416-1.024.664-1.92.744v.072c1.088.08 1.848.384 2.28.912.432.512.648 1.24.648 2.184 0 .8-.16 1.424-.48 1.872-.304.432-.8.736-1.488.912-.672.176-1.576.264-2.712.264-.816 0-1.528-.008-2.136-.024-.608 0-1.168-.016-1.68-.048-.496-.016-1.024-.04-1.584-.072l.288-1.512c.32.016.912.032 1.776.048h3.048c.72 0 1.296-.048 1.728-.144.432-.112.736-.304.912-.576.192-.272.288-.656.288-1.152 0-.752-.224-1.264-.672-1.536-.448-.288-1.24-.432-2.376-.432h-4.728v-1.464h4.728c.672 0 1.208-.048 1.608-.144s.688-.272.864-.528c.176-.272.264-.64.264-1.104 0-.448-.096-.792-.288-1.032s-.512-.408-.96-.504-1.048-.144-1.8-.144c-.688-.016-1.312-.024-1.872-.024-.544 0-1.024.008-1.44.024-.416 0-.776.016-1.08.048l-.288-1.512c.496-.048.968-.08 1.416-.096s.936-.024 1.464-.024c.528-.016 1.152-.024 1.872-.024zm-2.832.144v11.688h-1.92v-11.688zm16.314-.312c1.344 0 2.416.2 3.216.6s1.376 1.056 1.728 1.968c.368.896.552 2.088.552 3.576s-.184 2.688-.552 3.6c-.352.896-.928 1.544-1.728 1.944s-1.872.6-3.216.6-2.424-.2-3.24-.6c-.8-.4-1.384-1.048-1.752-1.944-.352-.912-.528-2.112-.528-3.6s.176-2.68.528-3.576c.368-.912.952-1.568 1.752-1.968.816-.4 1.896-.6 3.24-.6zm0 1.728c-.848 0-1.52.136-2.016.408-.496.256-.848.704-1.056 1.344s-.312 1.528-.312 2.664.104 2.024.312 2.664.56 1.096 1.056 1.368c.496.256 1.168.384 2.016.384s1.512-.128 1.992-.384c.496-.272.848-.728 1.056-1.368s.312-1.528.312-2.664-.104-2.024-.312-2.664-.56-1.088-1.056-1.344c-.48-.272-1.144-.408-1.992-.408zm13.571-1.44v11.688h-2.04v-11.688zm4.224 0v1.68h-10.512v-1.68zm4.542 0v11.688h-2.016v-11.688zm6.36 4.704v1.56h-6.504v-1.56zm1.8-4.704v11.688h-2.016v-11.688zm8.544 4.536c1.168 0 2.08.112 2.736.336s1.12.608 1.392 1.152c.288.528.432 1.248.432 2.16 0 .944-.144 1.688-.432 2.232-.288.528-.744.896-1.368 1.104s-1.44.312-2.448.312c-.768 0-1.432-.008-1.992-.024-.56 0-1.072-.016-1.536-.048-.464-.016-.952-.04-1.464-.072l.264-1.536c.288.016.824.032 1.608.048.8.016 1.736.024 2.808.024.624 0 1.112-.056 1.464-.168.368-.112.632-.32.792-.624s.24-.744.24-1.32c0-.768-.176-1.304-.528-1.608-.336-.304-.992-.456-1.968-.456h-4.44v-1.512zm-2.76-4.536v11.688h-1.992v-11.688zm11.52 0v11.688h-2.064v-11.688zm16.913 0c.512 0 .768.256.768.768l.504 10.92h-1.896l-.456-10.128h-.408l-2.976 8.184c-.064.208-.16.376-.288.504-.128.112-.304.168-.528.168h-1.584c-.224 0-.4-.056-.528-.168-.112-.128-.208-.296-.288-.504l-2.976-8.184h-.408l-.432 10.128h-1.872l.48-10.92c0-.512.264-.768.792-.768h2.112c.224 0 .392.056.504.168.128.112.224.28.288.504l2.424 6.72c.112.288.208.568.288.84s.152.552.216.84h.384c.08-.304.16-.592.24-.864s.168-.544.264-.816l2.424-6.72c.144-.448.416-.672.816-.672zm16.073-5.088c1.28 0 2.312.144 3.096.432.784.272 1.352.752 1.704 1.44.368.688.552 1.656.552 2.904 0 .896-.104 1.648-.312 2.256-.208.592-.536 1.056-.984 1.392-.432.32-1.016.528-1.752.624v.12c.272.064.536.2.792.408.272.192.52.456.744.792.224.32.392.712.504 1.176l1.608 5.232h-2.256l-1.464-5.184c-.208-.624-.488-1.064-.84-1.32-.352-.272-.808-.408-1.368-.408-.976 0-1.824 0-2.544 0-.72-.016-1.32-.032-1.8-.048s-.864-.024-1.152-.024l.072-1.752h5.352c.816-.016 1.456-.112 1.92-.288.48-.176.824-.488 1.032-.936.208-.464.312-1.104.312-1.92s-.104-1.44-.312-1.872c-.208-.448-.552-.76-1.032-.936-.464-.176-1.104-.264-1.92-.264-1.312 0-2.448.008-3.408.024-.944.016-1.584.024-1.92.024l-.336-1.656c.608-.064 1.176-.112 1.704-.144s1.104-.048 1.728-.048c.64-.016 1.4-.024 2.28-.024zm-3.624.216v16.56h-2.088v-16.56zm14.5 4.872v8.208c-.016.736.12 1.256.408 1.56s.768.456 1.44.456c.656 0 1.304-.152 1.944-.456.656-.32 1.44-.776 2.352-1.368l.264 1.416c-.912.72-1.8 1.264-2.664 1.632-.848.368-1.712.552-2.592.552-2.128 0-3.192-1.072-3.192-3.216v-8.784zm7.968 0v11.688h-1.632l-.192-2.208-.216-.36v-9.12zm7.64-.288c.512 0 1.056.016 1.632.048s1.144.072 1.704.12c.576.048 1.104.112 1.584.192l-.168 1.488c-.736-.032-1.48-.056-2.232-.072-.736-.032-1.472-.048-2.208-.048-.72-.016-1.288 0-1.704.048s-.72.176-.912.384c-.176.208-.264.56-.264 1.056 0 .608.144 1.008.432 1.2s.712.352 1.272.48l3.408.768c.928.224 1.608.568 2.04 1.032.448.464.672 1.192.672 2.184 0 .96-.184 1.68-.552 2.16-.352.48-.896.8-1.632.96s-1.672.24-2.808.24c-.416 0-1.04-.016-1.872-.048-.816-.032-1.72-.128-2.712-.288l.144-1.488c.384.016.792.04 1.224.072.432.016.88.024 1.344.024h1.464c.88 0 1.568-.04 2.064-.12s.848-.232 1.056-.456c.208-.24.312-.592.312-1.056 0-.576-.168-.96-.504-1.152s-.784-.352-1.344-.48l-3.36-.768c-.64-.16-1.152-.368-1.536-.624-.384-.272-.664-.616-.84-1.032-.176-.432-.264-.968-.264-1.608 0-.912.16-1.6.48-2.064s.816-.776 1.488-.936 1.536-.232 2.592-.216zm15.475 5.136v1.56h-7.32v-1.56zm5.861-9.72v13.2c0 .544.128.944.384 1.2.272.256.68.384 1.224.384h5.976l.096 1.632c-1.04.08-2.104.128-3.192.144-1.072.016-2.144.024-3.216.024-1.216 0-2.08-.296-2.592-.888s-.768-1.336-.768-2.232v-13.464zm16.768 0c.192 0 .36.056.504.168.144.096.24.232.288.408l5.328 15.984h-2.184l-4.296-13.584c-.064-.224-.136-.448-.216-.672-.064-.24-.128-.464-.192-.672h-.672c-.064.208-.128.432-.192.672-.064.224-.136.448-.216.672l-4.296 13.584h-2.184l5.328-15.984c.048-.176.144-.312.288-.408.144-.112.312-.168.504-.168zm3.072 9.552v1.824h-8.4v-1.824zm9.986-9.84c.784.016 1.592.056 2.424.12s1.664.184 2.496.36l-.144 1.536c-.688-.032-1.448-.056-2.28-.072-.832-.032-1.632-.048-2.4-.048-.592 0-1.104.024-1.536.072-.416.032-.76.128-1.032.288-.272.144-.472.392-.6.744-.112.336-.168.808-.168 1.416 0 .912.16 1.552.48 1.92.336.352.872.616 1.608.792l3.36.84c1.28.304 2.152.84 2.616 1.608.48.752.72 1.768.72 3.048 0 .96-.112 1.736-.336 2.328-.208.592-.536 1.048-.984 1.368-.448.304-1.024.512-1.728.624-.704.128-1.536.192-2.496.192-.544 0-1.256-.024-2.136-.072-.864-.048-1.864-.176-3-.384l.144-1.56c.944.032 1.704.064 2.28.096.576.016 1.072.024 1.488.024h1.296c.848 0 1.512-.064 1.992-.192.496-.128.84-.384 1.032-.768.208-.384.312-.952.312-1.704 0-.64-.072-1.136-.216-1.488s-.376-.616-.696-.792c-.304-.192-.696-.344-1.176-.456l-3.432-.864c-1.2-.304-2.048-.832-2.544-1.584-.48-.752-.72-1.76-.72-3.024 0-.96.104-1.728.312-2.304.224-.592.552-1.032.984-1.32.448-.304 1.008-.504 1.68-.6s1.472-.144 2.4-.144zm15.325.288c.192 0 .36.056.504.168.144.096.24.232.288.408l5.328 15.984h-2.184l-4.296-13.584c-.064-.224-.136-.448-.216-.672-.064-.24-.128-.464-.192-.672h-.672c-.064.208-.128.432-.192.672-.064.224-.136.448-.216.672l-4.296 13.584h-2.184l5.328-15.984c.048-.176.144-.312.288-.408.144-.112.312-.168.504-.168zm3.072 9.552v1.824h-8.4v-1.824z"/></g></svg>';

const lineColor = '#BDBDBD';
const blueLine = '#779CFF';
const heights_name = [50, 20, 15, 130];

function getFile(event) {
  const checkFile = event.target.files[0];
  const reader = new FileReader();
  file_type = checkFile.type;
  file_name = checkFile.name.split('.csv')[0];

  if (file_type !== 'text/csv') {    
    input.value = '';
    error.classList.add('error_shown');
    throw 'wrong type';
  }

  reader.onload = function(event) {
    const text = event.target.result;
    processCSV(text);
  };

  reader.readAsText(checkFile);
  input.value = '';
  input.classList.add('input_hidden');
  button.classList.add('download_shown');
  error.classList.remove('error_shown');
  text.innerHTML = 'Бейджи сгенерированы.'
  text.classList.add('text_success');
};

function processCSV(text) {
  const lines = text.split('\n');
  const filter = lines[0].split(',');
  
  // Фамилия", "Имя", "Отчество", "Организация", "Статус\r"

  filter.forEach((word, index) => {
    if (word.split('\r')[0] === 'Фамилия') {
      filterObject.surname = index;
    }
    if (word.split('\r')[0] === 'Имя') {
      filterObject.name = index;
    }
    if (word.split('\r')[0] === 'Отчество') {
      filterObject.patronymic = index;
    }
    if (word.split('\r')[0] === 'Организация') {
      filterObject.org = index;
    }
    if (word.split('\r')[0] === 'Статус') {
      filterObject.role = index;
    }
  });  
  
  lines.forEach(line => {
    const columns = line.split(',');    
    preProceededData.push(columns);
  });        
};

function readFile(event) {  
  event.preventDefault();

  for (let i = 1; i < preProceededData.length; i = i + 3) {
    const firstObject = {};
    const secondObject = {};
    const thirdObject = {};
    let nextPage = {};

    firstObject.surname = preProceededData[i][filterObject.surname].split('\r')[0];
    firstObject.name = preProceededData[i][filterObject.name].split('\r')[0];
    firstObject.patronymic = preProceededData[i][filterObject.patronymic].split('\r')[0];
    firstObject.org = preProceededData[i][filterObject.org].split('\r')[0];
    firstObject.role = preProceededData[i][filterObject.role].split('\r')[0];
    
    firstObject.style = 'role_title';
    firstObject.fill = '#FFFFFF';
    secondObject.style = 'role_title';
    secondObject.fill = '#FFFFFF';
    thirdObject.style = 'role_title';
    thirdObject.fill = '#FFFFFF';

    if (firstObject.role === 'Организатор') {
      firstObject.style = 'role_title_red';
      firstObject.fill = '#FF0000';
    }

    if (preProceededData[i+1] === undefined) {
      secondObject.surname = ' ';
      secondObject.name = ' ';
      secondObject.patronymic = ' ';
      secondObject.org = ' ';
      secondObject.role = ' ';

      thirdObject.surname = ' ';
      thirdObject.name = ' ';
      thirdObject.patronymic = ' ';
      thirdObject.org = ' ';
      thirdObject.role = ' ';
    } else {
      secondObject.surname = preProceededData[i+1][filterObject.surname].split('\r')[0];
      secondObject.name = preProceededData[i+1][filterObject.name].split('\r')[0];
      secondObject.patronymic = preProceededData[i+1][filterObject.patronymic].split('\r')[0];
      secondObject.org = preProceededData[i+1][filterObject.org].split('\r')[0];
      secondObject.role = preProceededData[i+1][filterObject.role].split('\r')[0];      

      if (secondObject.role === 'Организатор') {
        console.log(secondObject.role);
        secondObject.style = 'role_title_red';
        secondObject.fill = '#FF0000';
      }
    }

    if (preProceededData[i+2] === undefined) {
      thirdObject.surname = ' ';
      thirdObject.name = ' ';
      thirdObject.patronymic = ' ';
      thirdObject.org = ' ';
      thirdObject.role = ' ';
    } else {
      thirdObject.surname = preProceededData[i+2][filterObject.surname].split('\r')[0];
      thirdObject.name = preProceededData[i+2][filterObject.name].split('\r')[0];
      thirdObject.patronymic = preProceededData[i+2][filterObject.patronymic].split('\r')[0];
      thirdObject.org = preProceededData[i+2][filterObject.org].split('\r')[0];
      thirdObject.role = preProceededData[i+2][filterObject.role].split('\r')[0];

      if (thirdObject.role === 'Организатор') {
        thirdObject.style = 'role_title_red';
        thirdObject.fill = '#FF0000';
      }

      nextPage = {text: '', pageBreak: 'before'};
    }

    const tablePart = {
      style: '',
      text: '',
      table: {
        heights: [50, 70, 215, 60, 50],
        widths: [5, 258, 258, 258, 5],          
        body: [
          [
            {
              border: [false, false, true, true],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, false, true, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, false, true, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, false, true, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, false, false, true],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
          ],
          [
            {
              border: [false, false, false, false],
              text: ''
            },
            {
              border: [false, false, false, true],
              borderColor: [lineColor, lineColor, lineColor, blueLine],
              svg: logo,
              width: 258,
            },
            {
              border: [false, false, false, true],
              borderColor: [lineColor, lineColor, lineColor, blueLine],
              svg: logo,
              width: 258,
            },
            {
              border: [false, false, false, true],
              borderColor: [lineColor, lineColor, lineColor, blueLine],
              svg: logo,
              width: 258,
            },
            {
              border: [false, false, false, false],
              text: ''
            }
          ],
          [
            {
              border: [false, false, false, false],
              text: ''
            },
            {
              border: [false, false, false, false],
              table: {
                heights: heights_name,
                widths: [250],
                body: [
                  [
                    {
                      border: [false, false, false, false],
                      text: firstObject.surname, style: 'surname_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: firstObject.name, style: 'name_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: firstObject.patronymic, style: 'patronymic_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: firstObject.org, style: 'org_title'
                    }
                  ]
                ]
              }
            },
            {
              border: [false, false, false, false],
              table: {
                heights: heights_name,
                widths: [250],
                
                body: [
                  [
                    {
                      border: [false, false, false, false],
                      text: secondObject.surname, style: 'surname_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: secondObject.name, style: 'name_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: secondObject.patronymic, style: 'patronymic_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: secondObject.org, style: 'org_title'
                    }
                  ]
                ]
              }
            },
            {
              border: [false, false, false, false],
              table: {
                heights: heights_name,
                widths: [250],
                body: [
                  [
                    {
                      border: [false, false, false, false],
                      text: thirdObject.surname, style: 'surname_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: thirdObject.name, style: 'name_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: thirdObject.patronymic, style: 'patronymic_title'
                    }
                  ],
                  [
                    {
                      border: [false, false, false, false],
                      text: thirdObject.org, style: 'org_title'
                    }
                  ]
                ]
              }
            },
            {
              border: [false, false, false, false],
              text: ''
            }
          ],
          [
            {
              border: [false, false, false, false],
              text: ''
            },
            {
              border: [false, true, false, false],
              borderColor: [lineColor, blueLine, lineColor, lineColor],
              fillColor: firstObject.fill,
              text: firstObject.role, style: firstObject.style
            },
            {
              border: [false, true, false, false],
              borderColor: [lineColor, blueLine, lineColor, lineColor],
              fillColor: secondObject.fill,
              text: secondObject.role, style: secondObject.style
            },
            {
              border: [false, true, false, false],
              borderColor: [lineColor, blueLine, lineColor, lineColor],
              fillColor: thirdObject.fill,
              text: thirdObject.role, style: thirdObject.style
            },
            {
              border: [false, false, false, false],
              text: ''
            }
          ],
          [
            {
              border: [false, true, true, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, false, true, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, false, true, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, false, true, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            },
            {
              border: [true, true, false, false],
              borderColor: [lineColor, lineColor, lineColor, lineColor],
              text: ''
            }
          ]
        ]
      }
    };    
    
    tableReady.push(tablePart);
    tableReady.push(nextPage);
  };

  

  const pdfData = {
    pageSize: 'A4',
    pageOrientation: 'landscape',
    pageMargins: [7, 10, 7, 10],
    content: tableReady,
    styles: {
      surname_title: {
        fontSize: 22,
        bold: true,
        alignment: 'center',
        margin: [0, 30, 0, 0]
      },
      name_title: {
        fontSize: 22,
        alignment: 'center',
        margin: [0, 10, 0, 0]
      },
      patronymic_title: {
        fontSize: 22,
        alignment: 'center'
      },
      org_title: {
        fontSize: 12,
        alignment: 'center',
        margin: [0, 30, 0, 0]
      },
      role_title: {
        fontSize: 22,
        alignment: 'center',
        color: '#1A41FF',
        margin: [0, 20, 0, 0]
      },
      role_title_red: {
        fontSize: 22,
        alignment: 'center',
        color: '#FFFFFF',
        margin: [0, 20, 0, 0]
      }
    },
    defaultStyle: {

    }
  };
  const pdfName = file_name + '.pdf';
  pdfMake.createPdf(pdfData).download(pdfName);
  setTimeout(1000, () => {
    tableReady.length = 0;
  })
};

